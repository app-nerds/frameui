const DateFormats={IsoWithTimezone:"yyyy-mm-ddthh:mm:ssz",IsoWithoutTimezone:"yyyy-mm-ddthh:mm:ss",InternationalWithSeconds:"yyyy-mm-dd hh:mm:ss",International:"yyyy-mm-dd hh:mm",UsDateTimeWithSeconds:"mm/dd/yyyy hh:mm:ss am/pm",UsDateTimeWithoutSeconds:"mm/dd/yyyy hh:mm am/pm",IsoDate:"yyyy-mm-dd",UsDate:"mm/dd/yyyy"},formatMap={"yyyy-mm-ddthh:mm:ssz":format1,"yyyy-mm-ddthh:mm:ss":format2,"yyyy-mm-dd hh:mm:ss":format3,"yyyy-mm-dd hh:mm":format4,"mm/dd/yyyy hh:mm:ss am/pm":format5,"mm/dd/yyyy hh:mm am/pm":format6,"yyyy-mm-dd":format7,"mm/dd/yyyy":format8};function parseDateTime(dt){return"number"==typeof dt?new Date(dt):dt instanceof Date?dt:"string"==typeof dt?parseDateString(dt):void 0}function formatDateTime(dt,format){dt=parseDateTime(dt);let e=formatMap[format.toLowerCase()];if(e)return e(dt);throw new Error("Invalid date format: "+format)}function format1(dt){var{year:dt,month:e,day:t,hour:a,minute:n,second:r}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(e)}-${zeroPad(t)}T${zeroPad(a)}:${zeroPad(n)}:${zeroPad(r)}Z`}function format2(dt){var{year:dt,month:e,day:t,hour:a,minute:n,second:r}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(e)}-${zeroPad(t)}T${zeroPad(a)}:${zeroPad(n)}:`+zeroPad(r)}function format3(dt){var{year:dt,month:e,day:t,hour:a,minute:n,second:r}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(e)}-${zeroPad(t)} ${zeroPad(a)}:${zeroPad(n)}:`+zeroPad(r)}function format4(dt){var{year:dt,month:e,day:t,hour:a,minute:n}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(e)}-${zeroPad(t)} ${zeroPad(a)}:`+zeroPad(n)}function format5(dt){let{year:e,month:t,day:a,hour:n,minute:r,second:i}=breakDownDate(dt),o="AM";return 12<n&&(o="PM",n-=12),0===n&&(n=12),`${zeroPad(t)}/${zeroPad(a)}/${zeroPad(e)} ${zeroPad(n)}:${zeroPad(r)}:${zeroPad(i)} `+o}function format6(dt){let{year:e,month:t,day:a,hour:n,minute:r}=breakDownDate(dt),i="AM";return 12<n&&(i="PM",n-=12),0===n&&(n=12),`${zeroPad(t)}/${zeroPad(a)}/${zeroPad(e)} ${zeroPad(n)}:${zeroPad(r)} `+i}function format7(dt){var{year:dt,month:e,day:t}=breakDownDate(dt);return`${zeroPad(dt)}-${zeroPad(e)}-`+zeroPad(t)}function format8(dt){var{year:dt,month:e,day:t}=breakDownDate(dt);return`${zeroPad(e)}/${zeroPad(t)}/`+zeroPad(dt)}function breakDownDate(dt){return{year:dt.getFullYear(),month:dt.getMonth()+1,day:dt.getDate(),hour:dt.getHours(),minute:dt.getMinutes(),second:dt.getSeconds()}}function zeroPad(num){return num.toString().padStart(2,"0")}function parseDateString(dt){var t=[/(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})t(?<hour>\d{2}):(?<minute>\d{2}):(?<second>\d{2})z/i,/(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})t(?<hour>\d{2}):(?<minute>\d{2}):(?<second>\d{2})/i,/(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})\s+(?<hour>\d{2}):(?<minute>\d{2}):(?<second>\d{2})/i,/(?<month>\d{2})\/(?<day>\d{2})\/(?<year>\d{4})\s+(?<hour>\d{2}):(?<minute>\d{2}):(?<second>\d{2})\s*(?<meridian>am|pm)/i,/(?<month>\d{2})\/(?<day>\d{2})\/(?<year>\d{4})\s+(?<hour>\d{2}):(?<minute>\d{2})\s*(?<meridian>am|pm)/i,/(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/,/(?<month>\d{2})\/(?<day>\d{2})\/(?<year>\d{4})/];for(let e=0;e<t.length;e++){var a=dt.match(t[e]);if(a){var n=parseInt(a.groups.year)||(new Date).getFullYear(),r=parseInt(a.groups.month)||(new Date).getMonth(),i=parseInt(a.groups.day)||(new Date).getDate();let e=parseInt(a.groups.hour)||0;var o=parseInt(a.groups.minute)||0,d=parseInt(a.groups.second)||0;let t=a.groups.meridian||"";return""!==t&&"pm"===t.toLowerCase()&&e<12&&(e+=12),new Date(n,r-1,i,e,o,d)}}throw new Error("no pattern match for "+dt)}class DateTimePicker extends HTMLElement{constructor(){super(),this._daysOfTheWeek=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this._months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.name=this.getAttribute("name")||"dateTime",this.date=this.getAttribute("date")?parseDateTime(this.getAttribute("date")):"",this.dateFormat=this.getAttribute("date-format")||DateFormats.IsoWithTimezone,this.showTimeSelector=this.dateFormat===DateFormats.IsoWithTimezone||this.dateFormat===DateFormats.IsoWithoutTimezone||this.dateFormat===DateFormats.UsDateTimeWithSeconds||this.dateFormat===DateFormats.UsDateTimeWithoutSeconds||this.dateFormat===DateFormats.InternationalWithSeconds||this.dateFormat===DateFormats.International,this.twentyFourHourTime=this.dateFormat===DateFormats.IsoWithTimezone||this.dateFormat===DateFormats.IsoWithoutTimezone||this.dateFormat===DateFormats.InternationalWithSeconds||this.dateFormat===DateFormats.International,this.timeIncrement=this.getAttribute("time-increment")||"hour",this.today=new Date,this.inputEl=null,this.popupEl=null,this.headerEl=null,this.bodyEl=null,this.day=0,this.timeSelectorEl=null,this.selectedTimeIndex=0,this.yearBlockStart=this._getYear()-5}connectedCallback(){this.setAttribute("name",this.name+"-datepicker"),this.setAttribute("aria-label","Date Picker"),this.inputEl=this._createInputEl();var e=this._createInputLabel();""===this.date&&(this.date=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate(),0,0,0),this.yearBlockStart=this._getYear()-5),this.popupEl=this._createPopupEl(),this._drawHeaderEl(),this._drawCalendarBody(),this.insertAdjacentElement("beforeend",this.inputEl),this.insertAdjacentElement("beforeend",e),this.insertAdjacentElement("beforeend",this.popupEl),document.addEventListener("click",e=>{e.target.contains(this.popupEl)||e.target.contains(this.inputEl)||this.popupEl.contains(e.target)||this.hide()})}clear(){this.inputEl.value=""}getDate(){return this.date}moveMonth(e,direction){e.preventDefault(),e.stopPropagation();let t=new Date(this.date);t.setMonth(t.getMonth()+direction),this.date=t,this.popupEl.querySelector("header button:nth-child(2)").innerText=this._getMonthName(),this.popupEl.querySelector("header button:nth-child(3)").innerText=this._getYear().toString(),this.popupEl.querySelector(".calendar-body").remove(),this._drawCalendarBody()}setDate(dt){this.date=dt,this.day=dt.getDate(),this._setInputDate()}toggle(){this.popupEl.classList.toggle("calendar-hidden"),this.inputEl.focus()}hide(){this.popupEl.classList.add("calendar-hidden")}_drawHeaderEl(){var e=this._createPreviousMonthButton(),t=this._createNextMonthButton(),a=this._createCurrentMonthButton(),n=this._createCurrentYearButton();this.headerEl.innerHTML="",this.headerEl.insertAdjacentElement("beforeend",e),this.headerEl.insertAdjacentElement("beforeend",a),this.headerEl.insertAdjacentElement("beforeend",n),this.headerEl.insertAdjacentElement("beforeend",t)}_drawCalendarBody(){let t=document.createElement("div"),a=this._createCalendarBodyWeekDiv(),e=this._getFirstDayOfMonth();var n=e.getDay();let r=this._getLastDayOfMonth();var i,o=r.getDate();let d=!1;t.classList.add("calendar-body");for(let e=0;e<o+n;e++){d||e===n&&(d=!0);var s=this._createCalendarBodyDayDiv(d,e,n);a.insertAdjacentElement("beforeend",s),(e+1)%7||(t.insertAdjacentElement("beforeend",a),a=this._createCalendarBodyWeekDiv())}""!==a.innerHTML&&t.insertAdjacentElement("beforeend",a),this.showTimeSelector&&(this._createTimeSelector(),t.insertAdjacentElement("beforeend",this.timeSelectorEl),i=this._createOkButton(),t.insertAdjacentElement("beforeend",i)),this._replaceBodyEl(t)}_drawMonthListBody(){const t=document.createElement("div");t.classList.add("month-list-body");for(let e=0;e<this._months.length;e++){var a=this._createMonthButton(e);t.insertAdjacentElement("beforeend",a)}this._replaceBodyEl(t)}_drawYearListBody(){const e=document.createElement("div"),t=(e.classList.add("year-list-body"),document.createElement("div"));t.classList.add("year-list");var a=this._createYearUpButton(),n=this._createYearDownButton();e.insertAdjacentElement("beforeend",a);for(let e=this.yearBlockStart;e<this.yearBlockStart+10;e++){var r=this._createYearButton(e);t.insertAdjacentElement("beforeend",r)}e.insertAdjacentElement("beforeend",t),e.insertAdjacentElement("beforeend",n),this._replaceBodyEl(e)}_getMonth(){return new Date(this.date).getMonth()}_getMonthName(){return this._months[this._getMonth()]}_getYear(){return new Date(this.date).getFullYear()}_getDay(){return new Date(this.date).getDate()}_getFirstDayOfMonth(){return new Date(this._getYear(),this._getMonth(),1)}_getLastDayOfMonth(){return new Date(this._getYear(),this._getMonth()+1,0)}_getHour(){return new Date(this.date).getHours()}_getMinute(){return new Date(this.date).getMinutes()}_getSecond(){return new Date(this.date).getSeconds()}_onCalendarDayClick(e,day){e.preventDefault(),e.stopPropagation(),this.day=day,this._setInputDate(),this.showTimeSelector?this._createTimeSelectorOptions():(this.toggle(),this.inputEl.focus())}_onHeaderMonthClick(e){e.preventDefault(),e.stopPropagation(),this._drawMonthListBody()}_onHeaderYearClick(e){e.preventDefault(),e.stopPropagation(),this._drawYearListBody()}_onMonthClick(e,monthIndex){e.preventDefault(),e.stopPropagation(),this.date=new Date(this._getYear(),monthIndex,1),this._setInputDate(),this._drawHeaderEl(),this._drawCalendarBody()}_onTimeChange(e){var t=e.target.value;this.selectedTimeIndex=e.target.selectedIndex,this.date=t,this._setInputDate()}_onYearClick(e,year){e.preventDefault(),e.stopPropagation(),this.date=new Date(year,this._getMonth(),1),this._setInputDate(),this._drawHeaderEl(),this._drawCalendarBody()}_onYearDownClick(e){e.preventDefault(),e.stopPropagation(),this.yearBlockStart+=10,this._drawYearListBody()}_onYearUpClick(e){e.preventDefault(),e.stopPropagation(),this.yearBlockStart-=10,this._drawYearListBody()}_replaceBodyEl(newBody){this.bodyEl.innerHTML="",this.bodyEl.insertAdjacentElement("beforeend",newBody)}_setInputDate(){var e=new Date(this._getYear(),this._getMonth(),this.day,this._getHour(),this._getMinute(),this._getSecond());this.inputEl.value=formatDateTime(e,this.dateFormat),this.dispatchEvent(new CustomEvent("change",{detail:{value:e}}))}_createCalendarBodyDayDiv(started,dayIndex,firstDayOfWeek){const a=Object.assign(document.createElement("div"),{className:"day"});if(started){let t=dayIndex-firstDayOfWeek+1;const n=Object.assign(document.createElement("button"),{innerText:""+t,type:"button"});n.addEventListener("click",e=>this._onCalendarDayClick.call(this,e,t)),new Date(this._getYear(),this._getMonth(),t)===this.today&&n.classList.add("today"),a.insertAdjacentElement("beforeend",n)}else a.classList.add("disabled");return a}_createCalendarBodyWeekDiv(){return Object.assign(document.createElement("div"),{className:"week"})}_createCurrentMonthButton(){const e=Object.assign(document.createElement("button"),{innerHTML:this._getMonthName(),type:"button"});return e.addEventListener("click",e=>this._onHeaderMonthClick.call(this,e)),e}_createCurrentYearButton(){const e=Object.assign(document.createElement("button"),{innerHTML:this._getYear().toString(),type:"button"});return e.addEventListener("click",e=>this._onHeaderYearClick.call(this,e)),e}_createInputEl(){const e=Object.assign(document.createElement("input"),{type:"text",name:this.name,"aria-describedby":this.name+"-format",value:this.date instanceof Date?formatDateTime(this.date,this.dateFormat):""});return e.addEventListener("click",()=>{""===this.date&&(this.date=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate(),0,0,0),this._drawHeaderEl(),this._drawCalendarBody()),this.toggle()}),e}_createInputLabel(){return Object.assign(document.createElement("p"),{innerText:`(${this.dateFormat})`,id:this.name+"-format"})}_createMonthButton(monthIndex){const t=Object.assign(document.createElement("button"),{innerText:this._months[monthIndex],type:"button"});return t.addEventListener("click",e=>this._onMonthClick.call(this,e,monthIndex)),t}_createNextMonthButton(){const e=Object.assign(document.createElement("button"),{innerHTML:'<i class="icon--mdi icon--mdi--arrow-right"></i>',type:"button"});return e.addEventListener("click",e=>this.moveMonth.call(this,e,1)),e}_createOkButton(){const e=Object.assign(document.createElement("button"),{innerText:"OK",type:"button",className:"ok"});return e.addEventListener("click",this.toggle.bind(this)),e}_createPopupEl(){this.headerEl=document.createElement("header"),this.bodyEl=document.createElement("section");const e=Object.assign(document.createElement("div"),{className:"date-time-picker-popup calendar-hidden",role:"dialog","aria-modal":"true","aria-label":"Choose Date"});return e.insertAdjacentElement("beforeend",this.headerEl),e.insertAdjacentElement("beforeend",this.bodyEl),e}_createPreviousMonthButton(){const e=Object.assign(document.createElement("button"),{innerHTML:'<i class="icon--mdi icon--mdi--arrow-left"></i>',type:"button"});return e.addEventListener("click",e=>this.moveMonth.call(this,e,-1)),e}_createTimeSelector(){this.timeSelectorEl=document.createElement("select"),this._createTimeSelectorOptions(),this.timeSelectorEl.addEventListener("change",this._onTimeChange.bind(this))}_createTimeSelectorOptions(){this.timeSelectorEl.innerHTML="";let t=1,n=("5minute"===this.timeIncrement&&(t=5),"10minute"===this.timeIncrement&&(t=10),"15minute"===this.timeIncrement&&(t=15),"30minute"===this.timeIncrement&&(t=30),"hour"===this.timeIncrement&&(t=60),new Date(this._getYear(),this._getMonth(),this._getDay(),0,0,0)),r=0;for(let e=0;e<1440;e+=t){let a=document.createElement("option");if(a.value=formatDateTime(n,this.dateFormat),r===this.selectedTimeIndex&&a.setAttribute("selected","selected"),this.twentyFourHourTime)a.innerText=n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0");else{let e=n.getHours(),t="AM";12<e&&(e-=12,t="PM"),12===e&&(t="PM"),0===e&&(e=12),a.innerText=`${e.toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")} `+t}this.timeSelectorEl.insertAdjacentElement("beforeend",a),n=new Date(n.getTime()+6e4*t),r++}}_createYearButton(year){const t=Object.assign(document.createElement("button"),{innerText:year.toString(),type:"button"});return t.addEventListener("click",e=>this._onYearClick.call(this,e,year)),t}_createYearDownButton(){const e=Object.assign(document.createElement("button"),{innerHTML:'<i class="icon--mdi icon--mdi--arrow-down"></i>',type:"button"});return e.addEventListener("click",e=>this._onYearDownClick.call(this,e)),e}_createYearUpButton(){const e=Object.assign(document.createElement("button"),{innerHTML:'<i class="icon--mdi icon--mdi--arrow-up"></i>',type:"button"});return e.addEventListener("click",e=>this._onYearUpClick.call(this,e)),e}}customElements.define("date-time-picker",DateTimePicker);export{DateTimePicker};